<!DOCTYPE html><html lang="en"><head><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-6H3Q6FY6LT"></script><script>
                  window.dataLayer = window.dataLayer || [];
                  function gtag(){dataLayer.push(arguments);}
                  gtag('js', new Date());

                  gtag('config', 'G-6H3Q6FY6LT', {
                    page_path: window.location.pathname,
                  });
          </script><meta charSet="UTF-8"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta property="og:type" content="website"/><meta property="twitter:card" content="summary_large_image"/><link rel="icon" href="/favicon.ico"/><title>20 years of experience in web animations with JavaScript</title><meta content="IE=edge" http-equiv="X-UA-Compatible"/><meta name="robots" content="follow, index"/><link href="/favicon.ico" rel="shortcut icon"/><meta content="Exploring CSS transition, animation, and web animations API gotchas, and how to overcome them ðŸ’ª." name="description"/><meta property="og:site_name" content="20 years of experience in web animations with JavaScript"/><meta property="og:description" content="Exploring CSS transition, animation, and web animations API gotchas, and how to overcome them ðŸ’ª."/><meta property="og:title" content="20 years of experience in web animations with JavaScript"/><meta property="og:image" content="https://abdullahgira.com/blog/20-years-of-experience-in-web-animations-with-javascript/blur-train.jpg"/><meta name="twitter:site" content="20 years of experience in web animations with JavaScript"/><meta name="twitter:title" content="20 years of experience in web animations with JavaScript"/><meta name="twitter:description" content="Exploring CSS transition, animation, and web animations API gotchas, and how to overcome them ðŸ’ª."/><meta name="twitter:image" content="https://abdullahgira.com/blog/20-years-of-experience-in-web-animations-with-javascript/blur-train.jpg"/><meta name="next-head-count" content="18"/><link rel="preload" href="https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages/_next/static/css/03d907dd836112ee895c.css" as="style"/><link rel="stylesheet" href="https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages/_next/static/css/03d907dd836112ee895c.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages/_next/static/chunks/main-74c41ec84421cfc6a77c.js" as="script"/><link rel="preload" href="https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" as="script"/><link rel="preload" href="https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages/_next/static/chunks/framework.9116e7bff2bfccdffa19.js" as="script"/><link rel="preload" href="https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages/_next/static/chunks/56cd26d444d73f0f229aa91ea40e6e66a0fd253d.7101e693ab2a6b706877.js" as="script"/><link rel="preload" href="https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages/_next/static/chunks/cd73ecfe054d650886617b2ea209b9c6c07feeb5.0ba519fdc474ef48b346.js" as="script"/><link rel="preload" href="https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages/_next/static/chunks/pages/_app-0256d2c6cabda463e362.js" as="script"/><link rel="preload" href="https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages/_next/static/chunks/d09f71c2771447e62661a7b2e7969c57ce47c1dd.1b53dfd49c7cb2c76036.js" as="script"/><link rel="preload" href="https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages/_next/static/chunks/pages/blog/%5Bslug%5D-64d3584f6be8bbaa29c6.js" as="script"/></head><body><div id="__next"><nav class="mb-10 border-t-4 border-blue-700"><div class="max-w-5xl mx-auto px-5 md:px-8"><div class="flex justify-between items-center"><div class="py-2 mr-auto -mt-1"><a href="/"><span class="text-lg font-bold tracking-tight">Abdullah Gira</span><span class="text-4xl text-blue-700">.</span></a></div><ul class="flex text-sm"><li><a href="/" class="py-2 hover:text-gray-700 mr-8 text-gray-500">Home</a></li><li><a href="/blog" class="py-2 hover:text-gray-700 undefined text-gray-700 border-b-2 border-blue-700 font-bold px-2">Blog</a></li></ul></div></div></nav><div class="px-5"><div id="skip"><section class="max-w-2xl m-auto my-4 sm:my-16"><div class="mb-10"><h1 class="text-5xl font-bold mb-4">20 years of experience in web animations with JavaScript</h1><div class="flex "><p class="mr-2"><time dateTime="2021-01-02T09:57:34.439Z">January	2, 2021</time></p><p class="mr-2">â€¢</p><p class="text-blue-700">3<!-- --> Min Read</p></div></div><article class="prose"><p>This post is a note-taking from <a href="https://www.youtube.com/watch?v=9-6CKCz58A8" target="_blank" rel='noopener'>Google Chrome Developers video</a> where Jake and Surma talks about Jake's journey with web animations.</p>
<h2>Table of content</h2>
<ul>
<li><a href="#css-transition">CSS transition</a></li>
<li><a href="#transition-problem">CSS transition problem</a></li>
<li><a href="#css-animation">CSS animation</a></li>
<li><a href="#web-animations-api">Web animations API</a></li>
<li><a href="#fill-forwards-gotcha">Fill forwards gotcha</a></li>
<li><a href="#fill-forwards-solution">ðŸŒŸ Fill forwards solution</a></li>
</ul>
<p>We will start the journey by first exploring the CSS transition.</p>
<h2>CSS transition <a name="css-transition"></a></h2>
<p>We will start the journey by first exploring the CSS transition.</p>
<div class="remark-highlight"><pre class="language-css"><code class="language-css"><span class="token selector"><span class="token class">.box</span></span> <span class="token punctuation">{</span>
  <span class="token property">transition</span><span class="token punctuation">:</span> opacity <span class="token number">500</span><span class="token unit">ms</span> ease-in-out<span class="token punctuation">;</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>This is nice when you need to make hover effects for example <strong>which is done in CSS</strong>.</p>
<div class="remark-highlight"><pre class="language-css"><code class="language-css"><span class="token selector"><span class="token class">.box</span><span class="token pseudo-class">:hover</span></span> <span class="token punctuation">{</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<h2>Transition problem <a name="transition-problem"></a></h2>
<p>Troubles start to come when using JavaScript for making transitions, For example, when a user clicks a button we want to start a transition.</p>
<div class="remark-highlight"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>body</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onClickHandler()<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Click me<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>body</span><span class="token punctuation">></span></span>
</code></pre></div>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">onClickHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> el <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">opacity</span> <span class="token operator">=</span> <span class="token string">"0"</span>
  <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token method function property-access">append</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">transition</span> <span class="token operator">=</span> <span class="token string">"opacity 500ms ease-in-out"</span>
  el<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">opacity</span> <span class="token operator">=</span> <span class="token string">"1"</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p><strong>Do you see the problem?</strong>
<img src="/blog/20-years-of-experience-in-web-animations-with-javascript/transition-problem.gif" alt="No transition happens when the button clicks" title="Transition Problem"></p>
<p>The problem is that the browser doesn't see the <code>opacity 0</code>; because the browser's render engine skips it, So the workaround is to use the <code>getComputedStyle(el).opacity</code>, since calling <code>getComputedStyle(el)</code> is not enough, <strong>we have to specify the opacity and then the browser will start to think of the style</strong>.</p>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">onClickHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> el <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">opacity</span> <span class="token operator">=</span> <span class="token string">"0"</span>
  <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token method function property-access">append</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>
<span class="remark-highlight-code-line">  <span class="token function">getComputedStyle</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">opacity</span>
</span>  el<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">transition</span> <span class="token operator">=</span> <span class="token string">"opacity 500ms ease-in-out"</span>
  el<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">opacity</span> <span class="token operator">=</span> <span class="token string">"1"</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p><img src="/blog/20-years-of-experience-in-web-animations-with-javascript/transition-solution.gif" alt="Transition now works when the button is clicked" title="Transition Solution"></p>
<p><strong>Removing the element</strong></p>
<p>Now we want to fade the element out, so</p>
<div class="remark-highlight"><pre class="language-js"><code class="language-js">el<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">opacity</span> <span class="token operator">=</span> <span class="token string">"0"</span>
</code></pre></div>
<p>Easy right? Now we want to remove it from the document after the animation is done, so we listen to the <code>transitionend</code> event.</p>
<div class="remark-highlight"><pre class="language-js"><code class="language-js">el<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">opacity</span> <span class="token operator">=</span> <span class="token string">"0"</span>
el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"transitionend"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div>
<p><strong>Do you see the problem?</strong></p>
<p>Not a problem if you didn't figure this one out, it's somewhat complicated, the problem is event bubbling (you can read more about this from <a href="https://en.wikipedia.org/wiki/Event_bubbling">Wikipedia</a> or from <a href="https://javascript.info/bubbling-and-capturing">javascript.info</a>). If the element you are listening to transitionend on had a parent that also has a transition going on (complicated transition scenario), the parent will also listen to that event and will be also removed from the dom. So we have to check that the element listening for the transitionend event is the one we expect.</p>
<div class="remark-highlight"><pre class="language-js"><code class="language-js">el<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">opacity</span> <span class="token operator">=</span> <span class="token string">"0"</span>
el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"transitionend"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
<span class="remark-highlight-code-line">  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">target</span> <span class="token operator">!==</span> el<span class="token punctuation">)</span> <span class="token keyword control-flow">return</span>
</span>  el<span class="token punctuation">.</span><span class="token method function property-access">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div>
<h2>CSS animation <a name="css-animation"></a></h2>
<p>With the slightly newer CSS animations this just works</p>
<div class="remark-highlight"><pre class="language-css"><code class="language-css"><span class="token atrule"><span class="token rule">@keyframes</span> fade-in</span> <span class="token punctuation">{</span>
  <span class="token selector">from</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> el <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">)</span>
el<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">animation</span> <span class="token operator">=</span> <span class="token string">"fade-in 500ms ease-in-out"</span>
<span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token method function property-access">append</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>
</code></pre></div>
<p>For fading out and removing</p>
<div class="remark-highlight"><pre class="language-css"><code class="language-css"><span class="token atrule"><span class="token rule">@keyframes</span> fade-in</span> <span class="token punctuation">{</span>
  <span class="token selector">from</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="remark-highlight-code-line"><span class="token atrule"><span class="token rule">@keyframes</span> fade-out</span> <span class="token punctuation">{</span>
</span><span class="remark-highlight-code-line">  <span class="token selector">from</span> <span class="token punctuation">{</span>
</span><span class="remark-highlight-code-line">    <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="remark-highlight-code-line">  <span class="token punctuation">}</span>
</span><span class="remark-highlight-code-line"><span class="token punctuation">}</span>
</span></code></pre></div>
<div class="remark-highlight"><pre class="language-js"><code class="language-js">el<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">animation</span> <span class="token operator">=</span> <span class="token string">"fade-out 500ms ease-in-out"</span>
el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"transitionend"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
<span class="remark-highlight-code-line">  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">target</span> <span class="token operator">!==</span> el<span class="token punctuation">)</span> <span class="token keyword control-flow">return</span>
</span>  el<span class="token punctuation">.</span><span class="token method function property-access">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div>
<p>We still need to deal with the event bubbling issue.</p>
<h2>Web animations API <a name="web-animations-api"></a></h2>
<p>With web animations API we can now do all the animation within javascript, for fading in</p>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> el <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token method function property-access">append</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
el<span class="token punctuation">.</span><span class="token method function property-access">animate</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>opacity<span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span> offset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>duration<span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span> easing<span class="token operator">:</span> <span class="token string">'ease-in-out'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>The browser by default will assume that you want to animate the opacity to 1 so there is no need to specify that.
For fading out</p>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> animation <span class="token operator">=</span> el<span class="token punctuation">.</span><span class="token method function property-access">animate</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>opacity<span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>duration<span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span> easing<span class="token operator">:</span> <span class="token string">'ease-in-out'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
animation<span class="token punctuation">.</span><span class="token method function property-access">onfinish</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> el<span class="token punctuation">.</span><span class="token method function property-access">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<h3>Animating to a lower opacity without removing from the DOM</h3>
<p>What if you want to animate something from whatever the opacity now to 0.3 and leave it there without removing it from the dom. Something like this:</p>
<div class="remark-highlight"><pre class="language-js"><code class="language-js">el<span class="token punctuation">.</span><span class="token method function property-access">animate</span><span class="token punctuation">(</span>
<span class="remark-highlight-code-line">  <span class="token punctuation">{</span>opacity<span class="token operator">:</span> <span class="token string">"0.3"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
</span>  <span class="token punctuation">{</span>
    duration<span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span>
    easing<span class="token operator">:</span> <span class="token string">"ease-in-out"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div>
<p><em>NOTE: Providing one keyframe implies the end keyframe, for some reason!</em></p>
<p><strong>Now, do you see the gotcha?</strong>
<img src="/blog/20-years-of-experience-in-web-animations-with-javascript/animating-to-lower-opacity.gif" alt="Animating to lower opacity demo" title="Animating to lower opacity problem"></p>
<p>The animation stops at the desired opacity, but once it is done animating the animation itself is gone, so it goes back to its original state.</p>
<p>The solution is to use <code>fill: forwards</code></p>
<div class="remark-highlight"><pre class="language-js"><code class="language-js">el<span class="token punctuation">.</span><span class="token method function property-access">animate</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>opacity<span class="token operator">:</span> <span class="token string">"0.3"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    duration<span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span>
    easing<span class="token operator">:</span> <span class="token string">"ease-in-out"</span><span class="token punctuation">,</span>
<span class="remark-highlight-code-line">    fill<span class="token operator">:</span> <span class="token string">"forwards"</span><span class="token punctuation">,</span>
</span>  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div>
<p><img src="/blog/20-years-of-experience-in-web-animations-with-javascript/sol-animating-to-lower-opacity.gif" alt="Animating to lower opacity solution demo" title="Animating to lower opacity solution"></p>
<h2>Fill fowrwards gotcha <a name="fill-forwards-gotcha"></a></h2>
<p>Suppose we later on decided to set the opacity of the <code>el</code> to 1</p>
<div class="remark-highlight"><pre class="language-js"><code class="language-js">el<span class="token punctuation">.</span><span class="token method function property-access">animate</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>opacity<span class="token operator">:</span> <span class="token string">"0.3"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    duration<span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span>
    easing<span class="token operator">:</span> <span class="token string">"ease-in-out"</span><span class="token punctuation">,</span>
    fill<span class="token operator">:</span> <span class="token string">"forwards"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
<span class="remark-highlight-code-line">el<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">opacity</span> <span class="token operator">=</span> <span class="token string">"1"</span>
</span></code></pre></div>
<p>This does nothing! Because the animation has a higher priority than the style and it is still running. The only thing that the animation doesn't have priority over is important styles.</p>
<h2>ðŸŒŸ Fill fowrwards Solution <a name="fill-forwards-solution"></a></h2>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">animateTo</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> keframes<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> anim <span class="token operator">=</span> element<span class="token punctuation">.</span><span class="token method function property-access">animate</span><span class="token punctuation">(</span>keyframes<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token spread operator">...</span>options<span class="token punctuation">,</span>
<span class="remark-highlight-code-line">    fill<span class="token operator">:</span> <span class="token string">"both"</span><span class="token punctuation">,</span>
</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  anim<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"finish"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
<span class="remark-highlight-code-line">    anim<span class="token punctuation">.</span><span class="token method function property-access">commitStyles</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="remark-highlight-code-line">    anim<span class="token punctuation">.</span><span class="token method function property-access">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword control-flow">return</span> anim
<span class="token punctuation">}</span>
</code></pre></div>
<p>Note the highlighted lines, <code>anim.commitStyles()</code> will commit the last styles applied to the element, but this doesn't happen, because at this point the animation has ended and returned to its original state, so <code>commitStyles()</code> doesn't have any effect. In order for <code>anim.commitStyles()</code> we have to use <code>fill: 'both'</code>. With <code>anim.cancel()</code> we can feel safe about the <code>fill: 'both'</code> because once the animation is finished, it's gonna be removed.</p>
<p>That's it for this post, I hope you've enjoyed it.</p>
</article></section></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"title":"20 years of experience in web animations with JavaScript","description":"Exploring CSS transition, animation, and web animations API gotchas, and how to overcome them ðŸ’ª.","socialImage":"/blog/20-years-of-experience-in-web-animations-with-javascript/blur-train.jpg","content":"\u003cp\u003eThis post is a note-taking from \u003ca href=\"https://www.youtube.com/watch?v=9-6CKCz58A8\" target=\"_blank\" rel='noopener'\u003eGoogle Chrome Developers video\u003c/a\u003e where Jake and Surma talks about Jake's journey with web animations.\u003c/p\u003e\n\u003ch2\u003eTable of content\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#css-transition\"\u003eCSS transition\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#transition-problem\"\u003eCSS transition problem\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#css-animation\"\u003eCSS animation\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#web-animations-api\"\u003eWeb animations API\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#fill-forwards-gotcha\"\u003eFill forwards gotcha\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#fill-forwards-solution\"\u003eðŸŒŸ Fill forwards solution\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWe will start the journey by first exploring the CSS transition.\u003c/p\u003e\n\u003ch2\u003eCSS transition \u003ca name=\"css-transition\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eWe will start the journey by first exploring the CSS transition.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.box\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003etransition\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e opacity \u003cspan class=\"token number\"\u003e500\u003c/span\u003e\u003cspan class=\"token unit\"\u003ems\u003c/span\u003e ease-in-out\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003eopacity\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis is nice when you need to make hover effects for example \u003cstrong\u003ewhich is done in CSS\u003c/strong\u003e.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.box\u003c/span\u003e\u003cspan class=\"token pseudo-class\"\u003e:hover\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003eopacity\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eTransition problem \u003ca name=\"transition-problem\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eTroubles start to come when using JavaScript for making transitions, For example, when a user clicks a button we want to start a transition.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebody\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebutton\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eonclick\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003eonClickHandler()\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eClick me\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebutton\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebody\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eonClickHandler\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e el \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ecreateElement\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"div\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eopacity\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0\"\u003c/span\u003e\n  \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ebody\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eappend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eel\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003etransition\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"opacity 500ms ease-in-out\"\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eopacity\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"1\"\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eDo you see the problem?\u003c/strong\u003e\n\u003cimg src=\"/blog/20-years-of-experience-in-web-animations-with-javascript/transition-problem.gif\" alt=\"No transition happens when the button clicks\" title=\"Transition Problem\"\u003e\u003c/p\u003e\n\u003cp\u003eThe problem is that the browser doesn't see the \u003ccode\u003eopacity 0\u003c/code\u003e; because the browser's render engine skips it, So the workaround is to use the \u003ccode\u003egetComputedStyle(el).opacity\u003c/code\u003e, since calling \u003ccode\u003egetComputedStyle(el)\u003c/code\u003e is not enough, \u003cstrong\u003ewe have to specify the opacity and then the browser will start to think of the style\u003c/strong\u003e.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eonClickHandler\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e el \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ecreateElement\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"div\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eopacity\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0\"\u003c/span\u003e\n  \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ebody\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eappend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eel\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"remark-highlight-code-line\"\u003e  \u003cspan class=\"token function\"\u003egetComputedStyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eel\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eopacity\u003c/span\u003e\n\u003c/span\u003e  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003etransition\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"opacity 500ms ease-in-out\"\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eopacity\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"1\"\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cimg src=\"/blog/20-years-of-experience-in-web-animations-with-javascript/transition-solution.gif\" alt=\"Transition now works when the button is clicked\" title=\"Transition Solution\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eRemoving the element\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eNow we want to fade the element out, so\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003eel\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eopacity\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eEasy right? Now we want to remove it from the document after the animation is done, so we listen to the \u003ccode\u003etransitionend\u003c/code\u003e event.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003eel\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eopacity\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0\"\u003c/span\u003e\nel\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"transitionend\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eremove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eDo you see the problem?\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eNot a problem if you didn't figure this one out, it's somewhat complicated, the problem is event bubbling (you can read more about this from \u003ca href=\"https://en.wikipedia.org/wiki/Event_bubbling\"\u003eWikipedia\u003c/a\u003e or from \u003ca href=\"https://javascript.info/bubbling-and-capturing\"\u003ejavascript.info\u003c/a\u003e). If the element you are listening to transitionend on had a parent that also has a transition going on (complicated transition scenario), the parent will also listen to that event and will be also removed from the dom. So we have to check that the element listening for the transitionend event is the one we expect.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003eel\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eopacity\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0\"\u003c/span\u003e\nel\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"transitionend\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003cspan class=\"remark-highlight-code-line\"\u003e  \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003etarget\u003c/span\u003e \u003cspan class=\"token operator\"\u003e!==\u003c/span\u003e el\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eremove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eCSS animation \u003ca name=\"css-animation\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eWith the slightly newer CSS animations this just works\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@keyframes\u003c/span\u003e fade-in\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003efrom\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003eopacity\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e el \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ecreateElement\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"div\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nel\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eanimation\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"fade-in 500ms ease-in-out\"\u003c/span\u003e\n\u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ebody\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eappend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eel\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFor fading out and removing\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@keyframes\u003c/span\u003e fade-in\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003efrom\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003eopacity\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"remark-highlight-code-line\"\u003e\u003cspan class=\"token atrule\"\u003e\u003cspan class=\"token rule\"\u003e@keyframes\u003c/span\u003e fade-out\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"remark-highlight-code-line\"\u003e  \u003cspan class=\"token selector\"\u003efrom\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"remark-highlight-code-line\"\u003e    \u003cspan class=\"token property\"\u003eopacity\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"remark-highlight-code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"remark-highlight-code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003eel\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eanimation\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"fade-out 500ms ease-in-out\"\u003c/span\u003e\nel\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"transitionend\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003cspan class=\"remark-highlight-code-line\"\u003e  \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003etarget\u003c/span\u003e \u003cspan class=\"token operator\"\u003e!==\u003c/span\u003e el\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eremove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWe still need to deal with the event bubbling issue.\u003c/p\u003e\n\u003ch2\u003eWeb animations API \u003ca name=\"web-animations-api\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eWith web animations API we can now do all the animation within javascript, for fading in\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e el \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ecreateElement\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'div'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ebody\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eappend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eel\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nel\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eanimate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003eopacity\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'0'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e offset\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003eduration\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e1000\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e easing\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'ease-in-out'\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe browser by default will assume that you want to animate the opacity to 1 so there is no need to specify that.\nFor fading out\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e animation \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eanimate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003eopacity\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'0'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003eduration\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e1000\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e easing\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'ease-in-out'\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nanimation\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eonfinish\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eremove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3\u003eAnimating to a lower opacity without removing from the DOM\u003c/h3\u003e\n\u003cp\u003eWhat if you want to animate something from whatever the opacity now to 0.3 and leave it there without removing it from the dom. Something like this:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003eel\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eanimate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n\u003cspan class=\"remark-highlight-code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003eopacity\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0.3\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e  \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    duration\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e500\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    easing\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"ease-in-out\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cem\u003eNOTE: Providing one keyframe implies the end keyframe, for some reason!\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eNow, do you see the gotcha?\u003c/strong\u003e\n\u003cimg src=\"/blog/20-years-of-experience-in-web-animations-with-javascript/animating-to-lower-opacity.gif\" alt=\"Animating to lower opacity demo\" title=\"Animating to lower opacity problem\"\u003e\u003c/p\u003e\n\u003cp\u003eThe animation stops at the desired opacity, but once it is done animating the animation itself is gone, so it goes back to its original state.\u003c/p\u003e\n\u003cp\u003eThe solution is to use \u003ccode\u003efill: forwards\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003eel\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eanimate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003eopacity\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0.3\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    duration\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e500\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    easing\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"ease-in-out\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"remark-highlight-code-line\"\u003e    fill\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"forwards\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cimg src=\"/blog/20-years-of-experience-in-web-animations-with-javascript/sol-animating-to-lower-opacity.gif\" alt=\"Animating to lower opacity solution demo\" title=\"Animating to lower opacity solution\"\u003e\u003c/p\u003e\n\u003ch2\u003eFill fowrwards gotcha \u003ca name=\"fill-forwards-gotcha\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eSuppose we later on decided to set the opacity of the \u003ccode\u003eel\u003c/code\u003e to 1\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003eel\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eanimate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003eopacity\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0.3\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    duration\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e500\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    easing\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"ease-in-out\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    fill\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"forwards\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"remark-highlight-code-line\"\u003eel\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eopacity\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"1\"\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis does nothing! Because the animation has a higher priority than the style and it is still running. The only thing that the animation doesn't have priority over is important styles.\u003c/p\u003e\n\u003ch2\u003eðŸŒŸ Fill fowrwards Solution \u003ca name=\"fill-forwards-solution\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eanimateTo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eelement\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e keframes\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e options\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e anim \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e element\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eanimate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ekeyframes\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token spread operator\"\u003e...\u003c/span\u003eoptions\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"remark-highlight-code-line\"\u003e    fill\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"both\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  anim\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"finish\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003cspan class=\"remark-highlight-code-line\"\u003e    anim\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ecommitStyles\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"remark-highlight-code-line\"\u003e    anim\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ecancel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e anim\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNote the highlighted lines, \u003ccode\u003eanim.commitStyles()\u003c/code\u003e will commit the last styles applied to the element, but this doesn't happen, because at this point the animation has ended and returned to its original state, so \u003ccode\u003ecommitStyles()\u003c/code\u003e doesn't have any effect. In order for \u003ccode\u003eanim.commitStyles()\u003c/code\u003e we have to use \u003ccode\u003efill: 'both'\u003c/code\u003e. With \u003ccode\u003eanim.cancel()\u003c/code\u003e we can feel safe about the \u003ccode\u003efill: 'both'\u003c/code\u003e because once the animation is finished, it's gonna be removed.\u003c/p\u003e\n\u003cp\u003eThat's it for this post, I hope you've enjoyed it.\u003c/p\u003e\n","readTime":3,"date":"2021-01-02T09:57:34.439Z"},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"20-years-of-experience-in-web-animations-with-javascript"},"buildId":"s4i8RSkgfcrS2311BF37E","assetPrefix":"https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages/_next/static/chunks/polyfills-4beebf4ac9054f0bf4e6.js"></script><script src="https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages/_next/static/chunks/main-74c41ec84421cfc6a77c.js" async=""></script><script src="https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" async=""></script><script src="https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages/_next/static/chunks/framework.9116e7bff2bfccdffa19.js" async=""></script><script src="https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages/_next/static/chunks/56cd26d444d73f0f229aa91ea40e6e66a0fd253d.7101e693ab2a6b706877.js" async=""></script><script src="https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages/_next/static/chunks/cd73ecfe054d650886617b2ea209b9c6c07feeb5.0ba519fdc474ef48b346.js" async=""></script><script src="https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages/_next/static/chunks/pages/_app-0256d2c6cabda463e362.js" async=""></script><script src="https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages/_next/static/chunks/d09f71c2771447e62661a7b2e7969c57ce47c1dd.1b53dfd49c7cb2c76036.js" async=""></script><script src="https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages/_next/static/chunks/pages/blog/%5Bslug%5D-64d3584f6be8bbaa29c6.js" async=""></script><script src="https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages/_next/static/s4i8RSkgfcrS2311BF37E/_buildManifest.js" async=""></script><script src="https://cdn.statically.io/gh/abdullahgira/abdullahgira.github.io/gh-pages/_next/static/s4i8RSkgfcrS2311BF37E/_ssgManifest.js" async=""></script></body></html>